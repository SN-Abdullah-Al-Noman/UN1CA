From 225223e68709a48fe803ae1db73352b468dcd019 Mon Sep 17 00:00:00 2001
From: Utkustnr <utkuustuner@proton.me>
Date: Thu, 21 Nov 2024 01:30:45 +0300
Subject: [PATCH] Allow app target SDK bypass

---
 .../server/pm/InstallPackageHelper.smali       | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

diff --git a/smali_classes3/com/android/server/pm/InstallPackageHelper.smali b/smali_classes3/com/android/server/pm/InstallPackageHelper.smali
index ec5212d8..f489b632 100644
--- a/smali_classes3/com/android/server/pm/InstallPackageHelper.smali
+++ b/smali_classes3/com/android/server/pm/InstallPackageHelper.smali
@@ -15924,6 +15924,24 @@
     :cond_12
     if-nez v10, :cond_14
 
+    iget-object v10, v7, Lcom/android/server/pm/InstallPackageHelper;->mContext:Landroid/content/Context;
+
+    invoke-virtual {v10}, Landroid/content/Context;->getContentResolver()Landroid/content/ContentResolver;
+
+    move-result-object v10
+
+    const-string v9, "unica_allow_sdkbypass"
+
+    const/4 v13, 0x0
+
+    invoke-static {v10, v9, v13}, Landroid/provider/Settings$System;->getInt(Landroid/content/ContentResolver;Ljava/lang/String;I)I
+
+    move-result v10
+
+    const/16 v13, -0x6e
+
+    if-nez v10, :goto_c
+
     invoke-interface {v3}, Lcom/android/server/pm/pkg/AndroidPackage;->getTargetSdkVersion()I
 
     move-result v10
-- 
2.43.0

